/**
 * BoxFish.js
 *
 * jQuery plugin to create dynamic resizing columnar boxes.
 *
 * @version: 0.2
 * @authors: Jeremy Harris
 * @license: MIT
 */
function filterSelect(t){var n=t.find(".magnet-filter"),e=t.find(".magnet-item");n.change(function(){var n=jQuery(this).val();e.each(function(){var e=jQuery(this);e.hasClass(n)||"all"===n?t.magnet("show",e):t.magnet("hide",e)})})}function initBoxfish(t,n,e){t.boxfish({columns:n,breakpoints:e})}function initInfiniteScroll(t,n,e,o,i,a){var r=t.find(".item").last();t.infinitescroll({loading:{msgText:"<em>Loading the next set of posts...</em>",img:i},navSelector:"#pagenav",nextSelector:"#pagenav a",itemSelector:".item"},function(){r.nextAll().addClass("hidden"),setTimeout(function(){var i=t.find("article");initBoxfish(i,e,o),jQuery().magnet&&n.magnet("refresh"),"fade"==a&&(r.nextAll().hide().removeClass("hidden"),r.nextAll().fadeIn()),r.nextAll().removeClass("hidden")},700)})}function initMagnet(t,n,e){imagesLoaded(t,function(){t.magnet({layoutMode:"tiled",animationType:e,duration:n})})}function addEvent(t,n,e){if(t.addEventListener)t.addEventListener(n,e,!1);else{if(!t.attachEvent)throw new Error("not supported or DOM not loaded");t.attachEvent("on"+n,function(){e.call(t)})}}function addResizeEvent(t){var n;addEvent(window,"resize",function(){n&&clearTimeout(n),n=setTimeout(t,100)})}!function($){$.fn.boxfish=function(t){function n(){e()}function e(){b=c(),w=d(),o()}function o(){var t=h(),n=p.first();T=parseInt(n.css("margin-left"),10)+parseInt(n.css("margin-right"),10),k=parseInt(n.css("padding-left"),10)+parseInt(n.css("padding-right"),10),horizontalBorders=parseInt(n.css("border-left-width"),10)+parseInt(n.css("border-right-width"),10),p.each(function(e,o){if($(this).hasClass("w2")){var i=$(this).attr("data-span");$(this).width(n.outerWidth()*i+T*(i-1)-32)}else $(this).width(t-(T+k+horizontalBorders))})}function a(){}function r(){var t=[];for(x=0;x<p.length;x++)topPos=p[x].offsetTop,t[topPos]||(t[topPos]=[]),t[topPos].push(p[x]);for(var n in t){for(maxRowHeight=[],x=0;x<t[n].length;x++){var e=$(t[n][x]).outerHeight(!0);maxRowHeight[n]||(maxRowHeight[n]=0),maxRowHeight[n]<e&&(maxRowHeight[n]=e)}for(x=0;x<t[n].length;x++)$(t[n][x]).animate({height:maxRowHeight[n]},1)}}function s(){return $(p).css("clear","")}function l(){var t=$(p).first(),n=$(t),e=$(t),o=0,i=0;s(),$(p).css("border","1px solid #DDD"),p.each(function(a,r){o=$(r).offset(),console.log("/=====================================\\"),console.log($(r).attr("id")+": LEFT = "+o.left+" ... TOP = "+o.top),console.log($(e).offset()),console.log("\\=====================================/"),i>0&&o.left==t.offset().left&&o.top>=e.offset().top&&(console.log("BOX "+$(n).attr("id")+" CLEARED"),console.log("COUNT: "+i),console.log("LEFT OFFSET: "+o.left),$(n).css("border","1px solid red"),e=null,e=$(r)),i++,n=$(r)}),console.log("--------------"),console.log("--------------"),console.log("--------------"),console.log("--------------")}function f(){var t=p.find("img");return t.each(function(t,n){return n.complete?"undefined"!=typeof n.naturalWidth&&0===n.naturalWidth?!1:void 0:!1}),!0}function c(){return parseInt(v.width(),10)}function d(){return parseInt(v.height(),10)}function h(){var t=[0,0],n=g.columns;for(i=0;i<g.breakpoints.length;i++)g.breakpoints[i][0]<b&&g.breakpoints[i][0]>t[0]&&(t=g.breakpoints[i]);return t[1]>0&&(n=t[1]),b/n}function u(){var t=0,n=0;return p.each(function(e,o){n=$(this).outerHeight(!0),n>t&&(t=n)}),t}var g=$.extend({columns:3,breakpoints:[]},t),p=$(this),m=p.length,v=p.parent(),b=c(),w=d(),T=0,k=0,E;p.addClass("boxfish-box"),v.addClass("boxfish-container"),e(),$(window).on("resize",function(){clearTimeout(E),E=setTimeout(n,100)});var I=function(){setTimeout(function(){f()?a():I()},100)};return I(),this.addBreakpoint=function(t,n){t=parseInt(t,10),n=parseInt(n,10);var e=!1;for(i=0;i<g.breakpoints.length;i++)if(g.breakpoints[i][0]==t){g.breakpoints[i][1]=n,e=!0;break}return e||(g.breakpoints[g.breakpoints.length]=[t,n]),o(),this},this}}(jQuery);